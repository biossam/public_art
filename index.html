<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ˆìˆ ê°€ í€˜ìŠ¤íŠ¸</title>
    <!-- Tailwind CSS CDNì„ ì‚¬ìš©í•˜ì—¬ ì‰½ê³  ë¹ ë¥´ê²Œ ìŠ¤íƒ€ì¼ë§í•©ë‹ˆë‹¤. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- html2canvas ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¦ì„œ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•©ë‹ˆë‹¤. -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <!-- Google Fontsì˜ Inter í°íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ ë° ì• ë‹ˆë©”ì´ì…˜ì„ ì •ì˜í•©ë‹ˆë‹¤. */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3e8ff;
            background-image: linear-gradient(135deg, #f3e8ff 0%, #d1c4e9 100%);
        }
        .container {
            max-width: 800px;
        }
        /* ì œëª©ì— ë¹›ë‚˜ëŠ” íš¨ê³¼ë¥¼ ì£¼ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
        .glow {
            animation: glow 1.5s ease-in-out infinite alternate;
        }
        @keyframes glow {
            from {
                text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #c3a3f5, 0 0 20px #c3a3f5, 0 0 25px #c3a3f5, 0 0 30px #c3a3f5, 0 0 35px #c3a3f5;
            }
            to {
                text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #d8b4fe, 0 0 40px #d8b4fe, 0 0 50px #d8b4fe, 0 0 60px #d8b4fe, 0 0 70px #d8b4fe;
            }
        }
        /* ë¯¸ì…˜ íƒ­ ë²„íŠ¼ì˜ ìƒ‰ìƒê³¼ ìŠ¤íƒ€ì¼ì„ ì •ì˜í•©ë‹ˆë‹¤. */
        .tab-button[data-mission-id="0"] { @apply bg-blue-100 text-blue-600 border-blue-300; }
        .tab-button[data-mission-id="0"].active { @apply bg-blue-200 text-blue-800 border-blue-500 shadow-lg; }
        
        .tab-button[data-mission-id="1"] { @apply bg-yellow-100 text-yellow-600 border-yellow-300; }
        .tab-button[data-mission-id="1"].active { @apply bg-yellow-200 text-yellow-800 border-yellow-500 shadow-lg; }
        
        .tab-button[data-mission-id="2"] { @apply bg-red-100 text-red-600 border-red-300; }
        .tab-button[data-mission-id="2"].active { @apply bg-red-200 text-red-800 border-red-500 shadow-lg; }

        .tab-button[data-mission-id="3"] { @apply bg-green-100 text-green-600 border-green-300; }
        .tab-button[data-mission-id="3"].active { @apply bg-green-200 text-green-800 border-green-500 shadow-lg; }

        .tab-button.active {
            transform: scale(1.05);
            transition: all 0.3s ease-in-out;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- ì›¹í˜ì´ì§€ ì „ì²´ë¥¼ ê°ì‹¸ëŠ” ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="container bg-white bg-opacity-70 backdrop-blur-lg rounded-3xl shadow-2xl p-8 md:p-12 text-center border-4 border-purple-200">
        <header class="mb-8">
            <h1 class="text-4xl md:text-5xl font-extrabold text-purple-800 glow">
                ì–´ëŠ ë‚  ëˆˆë– ë³´ë‹ˆ ì˜ˆìˆ ê°€ê°€ ë˜ì—ˆë‹¤
            </h1>
            <p class="text-lg text-purple-600 mt-2 font-semibold">
                ìƒˆë¡œìš´ ë¯¸ì…˜ì„ ìˆ˜í–‰í•˜ê³  ì˜ˆìˆ ê°€ë¡œ ê±°ë“­ë‚˜ì„¸ìš”!
            </p>
        </header>

        <!-- ë¯¸ì…˜ ì„ íƒ íƒ­ ë²„íŠ¼ ì„¹ì…˜ -->
        <div id="missionTabs" class="flex flex-wrap justify-center gap-2 mb-8">
            <button class="tab-button px-4 py-2 rounded-full font-bold text-sm border-2 transition-all duration-300 hover:scale-105 flex items-center relative" data-mission-id="1">
                <span class="mr-2">ê³µê³µë¯¸ìˆ ê°€</span>
                <span class="badge hidden absolute -top-1 -right-1 w-5 h-5 bg-purple-500 text-white rounded-full flex items-center justify-center text-xs shadow-md">âœ”ï¸</span>
            </button>
            <button class="tab-button px-4 py-2 rounded-full font-bold text-sm border-2 transition-all duration-300 hover:scale-105 flex items-center relative" data-mission-id="0">
                <span class="mr-2">ë™ì‹œëŒ€ ê³µê³µë¯¸ìˆ ê°€</span>
                <span class="badge hidden absolute -top-1 -right-1 w-5 h-5 bg-purple-500 text-white rounded-full flex items-center justify-center text-xs shadow-md">âœ”ï¸</span>
            </button>
            <button class="tab-button px-4 py-2 rounded-full font-bold text-sm border-2 transition-all duration-300 hover:scale-105 flex items-center relative" data-mission-id="2">
                <span class="mr-2">ì‚¬íšŒì°¸ì—¬ ê³µê³µë¯¸ìˆ ê°€</span>
                <span class="badge hidden absolute -top-1 -right-1 w-5 h-5 bg-purple-500 text-white rounded-full flex items-center justify-center text-xs shadow-md">âœ”ï¸</span>
            </button>
            <button class="tab-button px-4 py-2 rounded-full font-bold text-sm border-2 transition-all duration-300 hover:scale-105 active flex items-center relative" data-mission-id="3">
                <span class="mr-2">ì¬ì‚¬ìš© ê³µê³µë¯¸ìˆ ê°€</span>
                <span class="badge hidden absolute -top-1 -right-1 w-5 h-5 bg-purple-500 text-white rounded-full flex items-center justify-center text-xs shadow-md">âœ”ï¸</span>
            </button>
        </div>

        <!-- ë¯¸ì…˜ ì§„í–‰ ì„¹ì…˜ (ëª¨ë“  ë¯¸ì…˜ ì™„ë£Œ ì‹œ ìˆ¨ê²¨ì§‘ë‹ˆë‹¤) -->
        <div id="missionInputSection">
            <section class="mb-8 bg-purple-50 rounded-2xl p-6 border-2 border-purple-300">
                <h2 id="missionTitle" class="text-3xl font-bold text-purple-700 mb-4">
                    ë¯¸ì…˜: ì¬ì‚¬ìš© ê³µê³µë¯¸ìˆ ê°€
                </h2>
                <p id="missionDescription" class="text-gray-700 leading-relaxed mb-4">
                    ë²„ë ¤ì§€ëŠ” ì–‘ë§ëª©, í˜íŠ¸ë³‘, í—Œ ì˜· ë“± ì¬í™œìš©í’ˆì„ í™œìš©í•´ ì§€êµ¬ë¥¼ ìœ„í•œ ë©‹ì§„ ì˜ˆìˆ  ì‘í’ˆì„ ë§Œë“¤ì–´ë³´ì„¸ìš”. ì—¬ëŸ¬ë¶„ì˜ ì•„ì´ë””ì–´ë¡œ ì„¸ìƒì— ìƒˆë¡œìš´ ê°€ì¹˜ë¥¼ ë¶ˆì–´ë„£ì–´ ì£¼ì„¸ìš”.
                </p>
                <div id="missionTags" class="flex justify-center flex-wrap gap-4 text-sm font-medium text-purple-500">
                    <span class="bg-purple-200 px-3 py-1 rounded-full">#ê¸°í›„ìœ„ê¸°</span>
                    <span class="bg-purple-200 px-3 py-1 rounded-full">#ì—…ì‚¬ì´í´ë§</span>
                    <span class="bg-purple-200 px-3 py-1 rounded-full">#ì¬í™œìš©</span>
                </div>
            </section>

            <section class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">
                    ì˜ˆìˆ ê°€ ì´ë¦„ê³¼ ì‘í’ˆ ì•„ì´ë””ì–´
                </h2>
                <!-- ì˜ˆìˆ ê°€ ì´ë¦„ ì…ë ¥ í•„ë“œ -->
                <input
                    type="text"
                    id="nameInput"
                    placeholder="ì˜ˆìˆ ê°€ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"
                    class="w-full p-4 mb-4 rounded-xl border-2 border-purple-300 bg-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition duration-300"
                />
                <!-- ì‘í’ˆ ì•„ì´ë””ì–´ ì…ë ¥ í•„ë“œ -->
                <textarea
                    id="userIdeaInput"
                    placeholder="ì–´ë–¤ ì‘í’ˆì„ ë§Œë“¤ê³  ì‹¶ë‚˜ìš”? ì–´ë–¤ ì¬ë£Œë¥¼ ì‚¬ìš©í•  ê±´ê°€ìš”? ì‘í’ˆì— ë‹´ê³  ì‹¶ì€ ë©”ì‹œì§€ë¥¼ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”."
                    rows="6"
                    class="w-full p-4 rounded-xl border-2 border-purple-300 bg-white focus:outline-none focus:ring-2 focus:ring-purple-500 transition duration-300 resize-none"
                ></textarea>
            </section>
            
            <!-- ì…ë ¥ í•„ë“œê°€ ë¹„ì–´ìˆì„ ë•Œ í‘œì‹œë  ì—ëŸ¬ ë©”ì‹œì§€ ë°•ìŠ¤ -->
            <div id="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-xl relative hidden mb-4" role="alert">
                <span id="errorMessageText" class="block sm:inline"></span>
            </div>

            <div class="flex justify-center">
                <!-- ë¯¸ì…˜ ì™„ë£Œ ë²„íŠ¼ -->
                <button
                    id="completeMissionButton"
                    class="px-8 py-4 bg-purple-600 text-white font-extrabold rounded-full shadow-lg hover:bg-purple-700 transition duration-300 transform hover:scale-105 active:scale-95"
                >
                    ë¯¸ì…˜ ì™„ë£Œí•˜ê¸°!
                </button>
            </div>
        </div>

        <!-- ê°œë³„ ë¯¸ì…˜ ì™„ë£Œ ì‹œ ë‚˜íƒ€ë‚˜ëŠ” ê²°ê³¼ ì„¹ì…˜ -->
        <section id="resultSection" class="mt-8 hidden">
            <div class="bg-green-100 rounded-2xl p-6 border-2 border-green-400">
                <h2 class="text-3xl font-bold text-green-700 mb-2">
                    ì¶•í•˜í•©ë‹ˆë‹¤!
                </h2>
                <p class="text-lg text-gray-800">
                    <span id="username" class="font-extrabold"></span>ë‹˜ì€ ì´ì œ ì§„ì •í•œ <span id="artistTitle" class="font-extrabold"></span>ì…ë‹ˆë‹¤!
                </p>
                <div id="certificateIdea" class="mt-4 bg-white p-4 rounded-xl shadow-inner text-gray-600 italic">
                    <!-- ì‚¬ìš©ìì˜ ì•„ì´ë””ì–´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </section>

        <!-- ëª¨ë“  ë¯¸ì…˜ ì™„ë£Œ ì‹œ ë‚˜íƒ€ë‚˜ëŠ” ìµœì¢… í€˜ìŠ¤íŠ¸ ì™„ë£Œ ì„¹ì…˜ -->
        <section id="finalResultSection" class="mt-8 hidden">
            <div id="finalCertificateContainer" class="bg-indigo-100 rounded-2xl p-6 border-2 border-indigo-400">
                <h2 class="text-4xl font-extrabold text-indigo-700 mb-4">
                    ğŸ‰ í€˜ìŠ¤íŠ¸ ìµœì¢… ì™„ë£Œ! ğŸ‰
                </h2>
                <p class="text-xl text-gray-800 font-semibold">
                    ëª¨ë“  ë¯¸ì…˜ì„ ì™„ìˆ˜í•˜ê³  ì§„ì •í•œ ì˜ˆìˆ ê°€ë¡œ ê±°ë“­ë‚¬ìŠµë‹ˆë‹¤!
                </p>
                <div class="mt-4 text-gray-600">
                    <p class="text-lg">
                        <strong>ì˜ˆìˆ ê°€ ì´ë¦„:</strong> <span id="finalUsername" class="font-bold text-indigo-600"></span>
                    </p>
                    <div id="finalCertificateMessage" class="mt-4 bg-white p-4 rounded-xl shadow-inner text-gray-700 italic">
                        <p class="font-semibold text-center">
                            "ì˜ˆìˆ ì€ ìš°ë¦¬ ì£¼ë³€ì˜ ëª¨ë“  ê²ƒì´ ë  ìˆ˜ ìˆë‹µë‹ˆë‹¤."
                        </p>
                    </div>
                </div>
                <button id="downloadFinalCertificateButton" class="mt-4 px-6 py-3 bg-indigo-600 text-white font-bold rounded-full shadow-md hover:bg-indigo-700 transition duration-300 transform hover:scale-105 active:scale-95">
                    ìµœì¢… ì¦ì„œ ë‹¤ìš´ë¡œë“œ
                </button>
            </div>
        </section>
    </div>

    <script>
        // DOMContentLoaded ì´ë²¤íŠ¸ëŠ” HTML ë¬¸ì„œê°€ ì™„ì „íˆ ë¡œë“œë˜ê³  íŒŒì‹±ë˜ì—ˆì„ ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.
        document.addEventListener('DOMContentLoaded', () => {
            // í•„ìš”í•œ ëª¨ë“  HTML ìš”ì†Œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
            const missionTabs = document.getElementById('missionTabs');
            const missionInputSection = document.getElementById('missionInputSection');
            const missionTitle = document.getElementById('missionTitle');
            const missionDescription = document.getElementById('missionDescription');
            const missionTags = document.getElementById('missionTags');
            const nameInput = document.getElementById('nameInput');
            const userIdeaInput = document.getElementById('userIdeaInput');
            const completeMissionButton = document.getElementById('completeMissionButton');
            const resultSection = document.getElementById('resultSection');
            const finalResultSection = document.getElementById('finalResultSection');
            const usernameSpan = document.getElementById('username');
            const artistTitleSpan = document.getElementById('artistTitle');
            const certificateIdeaDiv = document.getElementById('certificateIdea');
            const errorMessageDiv = document.getElementById('errorMessage');
            const errorMessageText = document.getElementById('errorMessageText');
            const finalUsernameSpan = document.getElementById('finalUsername');
            const finalCertificateContainer = document.getElementById('finalCertificateContainer');
            const downloadFinalCertificateButton = document.getElementById('downloadFinalCertificateButton');

            // ë¯¸ì…˜ ë°ì´í„°ë¥¼ ë°°ì—´ë¡œ ì •ì˜í•©ë‹ˆë‹¤.
            const missions = [
                {
                    title: "ë¯¸ì…˜: ë™ì‹œëŒ€ ê³µê³µë¯¸ìˆ ê°€",
                    description: "ë‚¯ì„  ê²ƒì—ì„œ ì˜ˆìˆ  ì°¾ê¸°. ì„¸ìƒì— ì—†ëŠ” ìƒˆë¡œìš´ ì¬ë£Œì™€ ì•„ì´ë””ì–´ë¡œ ì˜ˆìˆ  ì‘í’ˆì„ ë§Œë“¤ì–´ë³´ì„¸ìš”. ì˜ˆìˆ ì€ ì •í•´ì§„ ì£¼ì œê°€ ì—†ë‹µë‹ˆë‹¤!",
                    tags: ["#ë™ì‹œëŒ€ë¯¸ìˆ ", "#ìƒˆë¡œìš´ì‹œë„", "#ì˜ˆìˆ ì˜ê²½ê³„"],
                    artistTitle: "ë™ì‹œëŒ€ ê³µê³µë¯¸ìˆ ê°€",
                    buttonColor: "bg-blue-100 text-blue-600 border-blue-300"
                },
                {
                    title: "ë¯¸ì…˜: ê³µê³µë¯¸ìˆ ê°€",
                    description: "ì¼ìƒ ê³µê°„ì— ì˜ˆìˆ ì„ ë”í•˜ê¸°. ì‚¬ëŒë“¤ì´ ìì£¼ ì˜¤ê°€ëŠ” ì¥ì†Œì— ë©‹ì§„ ì‘í’ˆì„ ì„¤ì¹˜í•´ ëª¨ë‘ì—ê²Œ ì˜ˆìˆ ì„ ì„ ë¬¼í•´ì£¼ì„¸ìš”.",
                    tags: ["#ê³µê³µë¯¸ìˆ ", "#ëª¨ë‘ì˜ì˜ˆìˆ ", "#ê³µê°„ë³€í™”"],
                    artistTitle: "ê³µê³µë¯¸ìˆ ê°€",
                    buttonColor: "bg-yellow-100 text-yellow-600 border-yellow-300"
                },
                {
                    title: "ë¯¸ì…˜: ì‚¬íšŒì°¸ì—¬ ê³µê³µë¯¸ìˆ ê°€",
                    description: "ì˜ˆìˆ ë¡œ ì„¸ìƒì— ë©”ì‹œì§€ ì „í•˜ê¸°. ì‚¬íšŒì  ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ë¶„ì˜ ìƒê°ì„ ì˜ˆìˆ  ì‘í’ˆì— ë‹´ì•„ ì„¸ìƒì— í° ìš¸ë¦¼ì„ ì£¼ì„¸ìš”.",
                    tags: ["#ì‚¬íšŒì°¸ì—¬ë¯¸ìˆ ", "#ë©”ì‹œì§€", "#ì„¸ìƒì—ìš¸ë¦¼"],
                    artistTitle: "ì‚¬íšŒì°¸ì—¬ ê³µê³µë¯¸ìˆ ê°€",
                    buttonColor: "bg-red-100 text-red-600 border-red-300"
                },
                {
                    title: "ë¯¸ì…˜: ì¬ì‚¬ìš© ê³µê³µë¯¸ìˆ ê°€",
                    description: "ë²„ë ¤ì§€ëŠ” ì–‘ë§ëª©, í˜íŠ¸ë³‘, í—Œ ì˜· ë“± ì¬í™œìš©í’ˆì„ í™œìš©í•´ ì§€êµ¬ë¥¼ ìœ„í•œ ë©‹ì§„ ì˜ˆìˆ  ì‘í’ˆì„ ë§Œë“¤ì–´ë³´ì„¸ìš”. ì—¬ëŸ¬ë¶„ì˜ ì•„ì´ë””ì–´ë¡œ ì„¸ìƒì— ìƒˆë¡œìš´ ê°€ì¹˜ë¥¼ ë¶ˆì–´ë„£ì–´ ì£¼ì„¸ìš”.",
                    tags: ["#ê¸°í›„ìœ„ê¸°", "#ì—…ì‚¬ì´í´ë§", "#ì¬í™œìš©"],
                    artistTitle: "ì¬ì‚¬ìš© ê³µê³µë¯¸ìˆ ê°€",
                    buttonColor: "bg-green-100 text-green-600 border-green-300"
                }
            ];

            let activeMissionId = 3; // ì´ˆê¸° í™œì„±í™”ëœ ë¯¸ì…˜ IDë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì™„ë£Œëœ ë¯¸ì…˜ ìƒíƒœë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
            const loadCompletedMissions = () => {
                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— 'completedMissions'ê°€ ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
                const completedMissions = JSON.parse(localStorage.getItem('completedMissions')) || [];
                // ë¯¸ì…˜ ë°°ì—´ì˜ ìœ íš¨í•œ IDë§Œ í•„í„°ë§í•©ë‹ˆë‹¤.
                return completedMissions.filter(id => id >= 0 && id < missions.length);
            };

            let completedMissions = loadCompletedMissions();

            // í˜„ì¬ ë¯¸ì…˜ì— ë”°ë¼ UIë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
            const updateMissionUI = (missionId) => {
                const mission = missions[missionId];
                missionTitle.textContent = mission.title;
                missionDescription.textContent = mission.description;
                missionTags.innerHTML = mission.tags.map(tag => `
                    <span class="bg-purple-200 px-3 py-1 rounded-full">${tag}</span>
                `).join('');

                const buttons = document.querySelectorAll('.tab-button');
                buttons.forEach(button => {
                    const missionIndex = parseInt(button.dataset.missionId);
                    // ëª¨ë“  í™œì„±í™” í´ë˜ìŠ¤ë¥¼ ì œê±°í•˜ê³  í˜„ì¬ ë¯¸ì…˜ì— ë§ëŠ” ìŠ¤íƒ€ì¼ì„ ì ìš©í•©ë‹ˆë‹¤.
                    button.classList.remove('active', 'bg-blue-100', 'text-blue-600', 'border-blue-300', 'bg-yellow-100', 'text-yellow-600', 'border-yellow-300', 'bg-red-100', 'text-red-600', 'border-red-300', 'bg-green-100', 'text-green-600', 'border-green-300');
                    button.classList.add(...missions[missionIndex].buttonColor.split(' '));

                    // ì™„ë£Œëœ ë¯¸ì…˜ì—ëŠ” ë±ƒì§€ ì•„ì´ì½˜ì„ í‘œì‹œí•©ë‹ˆë‹¤.
                    const badge = button.querySelector('.badge');
                    if (completedMissions.includes(missionIndex)) {
                        badge.classList.remove('hidden');
                    } else {
                        badge.classList.add('hidden');
                    }

                    if (missionIndex === missionId) {
                        button.classList.add('active');
                    }
                });
            };

            // ëª¨ë“  ë¯¸ì…˜ì´ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³  ìµœì¢… ê²°ê³¼ë¥¼ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
            const checkAllMissionsComplete = () => {
                if (completedMissions.length === missions.length) {
                    finalResultSection.classList.remove('hidden');
                    missionInputSection.classList.add('hidden'); // ë¯¸ì…˜ ì…ë ¥ ì„¹ì…˜ì„ ìˆ¨ê¹ë‹ˆë‹¤.
                    finalUsernameSpan.textContent = nameInput.value.trim() || 'ì˜ˆìˆ ê°€'; // ìµœì¢… ì¦ì„œì— ì´ë¦„ì„ í‘œì‹œí•©ë‹ˆë‹¤.
                } else {
                    finalResultSection.classList.add('hidden');
                    missionInputSection.classList.remove('hidden'); // ë¯¸ì…˜ ì…ë ¥ ì„¹ì…˜ì„ ë‹¤ì‹œ í‘œì‹œí•©ë‹ˆë‹¤.
                }
            };

            // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° UIë¥¼ ì„¤ì •í•˜ê³  ëª¨ë“  ë¯¸ì…˜ ì™„ë£Œ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
            updateMissionUI(activeMissionId);
            checkAllMissionsComplete();

            // íƒ­ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ: í´ë¦­ëœ ë¯¸ì…˜ìœ¼ë¡œ UIë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
            missionTabs.addEventListener('click', (e) => {
                const button = e.target.closest('.tab-button');
                if (button) {
                    activeMissionId = parseInt(button.dataset.missionId);
                    updateMissionUI(activeMissionId);
                }
            });

            // "ë¯¸ì…˜ ì™„ë£Œí•˜ê¸°!" ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            completeMissionButton.addEventListener('click', () => {
                console.log('ë¯¸ì…˜ ì™„ë£Œ ë²„íŠ¼ì´ í´ë¦­ë˜ì—ˆìŠµë‹ˆë‹¤.');
                const username = nameInput.value.trim();
                const userIdea = userIdeaInput.value.trim();
                
                errorMessageDiv.classList.add('hidden'); // ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.

                // ì…ë ¥ í•„ë“œì˜ ìœ íš¨ì„±ì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
                if (!username && !userIdea) {
                    errorMessageText.textContent = "ì˜ˆìˆ ê°€ ì´ë¦„ê³¼ ì‘í’ˆ ì•„ì´ë””ì–´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                    errorMessageDiv.classList.remove('hidden');
                } else if (!username) {
                    errorMessageText.textContent = "ì˜ˆìˆ ê°€ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                    errorMessageDiv.classList.remove('hidden');
                } else if (!userIdea) {
                    errorMessageText.textContent = "ì‘í’ˆ ì•„ì´ë””ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                    errorMessageDiv.classList.remove('hidden');
                } else {
                    // ë¯¸ì…˜ ì™„ë£Œ ì²˜ë¦¬
                    const mission = missions[activeMissionId];
                    
                    if (!completedMissions.includes(activeMissionId)) {
                        completedMissions.push(activeMissionId);
                        localStorage.setItem('completedMissions', JSON.stringify(completedMissions));
                        updateMissionUI(activeMissionId);
                    }

                    // ê°œë³„ ë¯¸ì…˜ ì™„ë£Œ ì¶•í•˜ ë©”ì‹œì§€ ë° ì•„ì´ë””ì–´ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
                    usernameSpan.textContent = username;
                    artistTitleSpan.textContent = mission.artistTitle;
                    certificateIdeaDiv.innerHTML = `
                        <p><strong>ì‘í’ˆ ì•„ì´ë””ì–´:</strong></p>
                        <p class="mt-2">${userIdea.replace(/\n/g, '<br>')}</p>
                        <p class="mt-4 text-center text-sm font-semibold">"ì˜ˆìˆ ì€ ìš°ë¦¬ ì£¼ë³€ì˜ ëª¨ë“  ê²ƒì´ ë  ìˆ˜ ìˆë‹µë‹ˆë‹¤."</p>
                    `;
                    resultSection.classList.remove('hidden');
                    
                    // ëª¨ë“  ë¯¸ì…˜ ì™„ë£Œ ìƒíƒœë¥¼ ë‹¤ì‹œ í™•ì¸í•˜ê³  ìµœì¢… ì¦ì„œë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
                    checkAllMissionsComplete();

                    // ê²°ê³¼ ì„¹ì…˜ìœ¼ë¡œ í™”ë©´ì„ ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤í•©ë‹ˆë‹¤.
                    resultSection.scrollIntoView({ behavior: 'smooth' });
                }
            });

            // "ìµœì¢… ì¦ì„œ ë‹¤ìš´ë¡œë“œ" ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            downloadFinalCertificateButton.addEventListener('click', () => {
                // ìµœì¢… ì¦ì„œ ì»¨í…Œì´ë„ˆë§Œ ìº¡ì²˜í•˜ì—¬ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.
                html2canvas(finalCertificateContainer, {
                    scale: 2, // ê³ í•´ìƒë„ ì´ë¯¸ì§€ë¥¼ ìœ„í•´ ìŠ¤ì¼€ì¼ì„ 2ë°°ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
                    useCORS: true
                }).then(canvas => {
                    const link = document.createElement('a');
                    link.download = 'í€˜ìŠ¤íŠ¸_ìµœì¢…_ì™„ë£Œ_ì¦ì„œ.png';
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                });
            });
        });
    </script>
</body>
</html>
